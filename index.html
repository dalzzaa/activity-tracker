<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Activity Tracking</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; font-family: sans-serif; }
        #app { display: flex; flex-direction: column; height: 100%; }
        .view { width: 100%; height: 100%; }
        .hidden { display: none; }

        /* Calendar View */
        #calendar-view { padding: 1rem; box-sizing: border-box; }

        /* Detail View */
        /* .hidden 클래스가 없을 때만 flex로 표시되도록 수정 */
        #detail-view.view:not(.hidden) {
            display: flex;
            flex-direction: column;
        }
        .detail-header { padding: 1rem; border-bottom: 1px solid #ccc; }
        .detail-header h2 { margin: 0 0 10px 0; }
        .title-container { display: flex; gap: 5px; }
        #detail-title-input { flex-grow: 1; font-size: 1.2em; border: 1px solid #ddd; padding: 5px; }
        #save-activity-btn { padding: 0 1rem; }
        .activity-controls { padding: 0.5rem 1rem; border-bottom: 1px solid #ccc; display: flex; align-items: center; gap: 10px; }
        .activity-controls span { font-weight: bold; }
        .detail-map-container { flex-grow: 1; position: relative; }
        #map { width: 100%; height: 100%; }
        .map-controls { position: absolute; top: 10px; right: 10px; z-index: 1000; background: white; padding: 5px; border-radius: 5px; }

        /* Memo Modal */
        #memo-modal { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; max-width: 400px; background: white; border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); z-index: 1001; padding: 1rem; box-sizing: border-box; }
        #memo-modal-content { display: flex; flex-direction: column; gap: 10px; }
        #memo-coords { font-size: 0.8em; color: #666; }
        #memo-textarea { width: 100%; height: 80px; resize: vertical; box-sizing: border-box; }
        .memo-actions { display: flex; justify-content: flex-end; gap: 10px; }
        .photo-actions { display: flex; gap: 10px; margin-top: 10px; }
        .photo-actions button { flex-grow: 1; }
        #photo-preview-container { margin-top: 10px; }
        #photo-preview { max-width: 100%; max-height: 150px; border-radius: 4px; }
        /* 숨겨진 file input */
        .hidden-file-input { display: none; }

        /* Modal Backdrop */
        #modal-backdrop { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000; }

    </style>
</head>
<body>

<div id="app">
    <!-- 캘린더 뷰 -->
    <div id="calendar-view" class="view"></div>

    <!-- 상세 뷰 (초기에는 숨김) -->
    <div id="detail-view" class="view hidden">
        <div class="detail-header">
            <button id="back-to-calendar-btn">← 목록으로</button>
            <h2 id="detail-date"></h2>
            <div class="title-container">
                <input type="text" id="detail-title-input" placeholder="활동 제목">
                <button id="save-activity-btn">저장</button>
            </div>
        </div>
        <div class="activity-controls">
            <span>활동 기록 제어:</span>
            <button id="start-tracking-btn" disabled>시작</button>
            <button id="pause-tracking-btn" disabled>중지</button>
            <button id="stop-tracking-btn" disabled>종료</button>
        </div>
        <div class="detail-map-container">
            <div id="map"></div>
            <!-- 메모 모달 (초기에는 숨김) -->
            <div id="modal-backdrop" class="hidden"></div>
            <div id="memo-modal" class="hidden">
                <div id="memo-modal-content">
                    <h3>메모</h3>
                    <div id="memo-coords"></div>
                    <textarea id="memo-textarea" placeholder="메모 내용을 입력하세요..."></textarea>
                    <div id="photo-preview-container" class="hidden">
                        <img id="photo-preview" src="" alt="사진 미리보기">
                    </div>
                    <div class="photo-actions">
                        <button id="take-photo-btn">사진 찍기</button>
                        <button id="select-photo-btn">사진 선택</button>
                        <input type="file" id="take-photo-input" class="hidden-file-input" accept="image/*" capture="environment">
                        <input type="file" id="select-photo-input" class="hidden-file-input" accept="image/*">
                    </div>
                    <div class="memo-actions">
                        <button id="memo-cancel-btn">취소</button>
                        <button id="memo-save-btn">저장</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
<script type="module" src="src/main.js"></script>
</body>
</html>